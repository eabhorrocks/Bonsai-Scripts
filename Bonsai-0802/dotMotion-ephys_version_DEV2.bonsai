<?xml version="1.0" encoding="utf-8"?>
<WorkflowBuilder Version="2.4.0-preview">
  <Workflow xmlns:q2="clr-namespace:Bonsai.Shaders.Input;assembly=Bonsai.Shaders" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:q3="clr-namespace:Bonsai.IO;assembly=Bonsai.System" xmlns:q7="clr-namespace:Bonsai.Arduino;assembly=Bonsai.Arduino" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:q5="clr-namespace:Bonsai.Shaders;assembly=Bonsai.Shaders" xmlns:q4="clr-namespace:;assembly=Extensions" xmlns:q6="clr-namespace:Bonsai.Scripting;assembly=Bonsai.Scripting" xmlns:q1="clr-namespace:Bonsai.Numerics;assembly=Bonsai.Numerics" xmlns="https://bonsai-rx.org/2018/workflow">
    <Nodes>
      <Expression xsi:type="Combinator">
        <Combinator xsi:type="StringProperty">
          <Value>DotMotion</Value>
        </Combinator>
      </Expression>
      <Expression xsi:type="Combinator">
        <Combinator xsi:type="q1:CreateRandom">
          <q1:Seed>10</q1:Seed>
        </Combinator>
      </Expression>
      <Expression xsi:type="AsyncSubject">
        <Name>Random</Name>
      </Expression>
      <Expression xsi:type="Combinator">
        <Combinator xsi:type="Take">
          <Count>1</Count>
        </Combinator>
      </Expression>
      <Expression xsi:type="ExternalizedProperty">
        <MemberName>TopBorder</MemberName>
        <Name>TopBorder</Name>
      </Expression>
      <Expression xsi:type="ExternalizedProperty">
        <MemberName>BottomBorder</MemberName>
        <Name>BottomBorder</Name>
      </Expression>
      <Expression xsi:type="ExternalizedProperty">
        <MemberName>LeftBorder</MemberName>
        <Name>LeftBorder</Name>
      </Expression>
      <Expression xsi:type="ExternalizedProperty">
        <MemberName>RightBorder</MemberName>
        <Name>RightBorder</Name>
      </Expression>
      <Expression xsi:type="ExternalizedProperty">
        <MemberName>InterStimInterval</MemberName>
        <Name>InterStimInterval</Name>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="Combinator">
          <Combinator xsi:type="q2:KeyDown">
            <q2:Key>S</q2:Key>
            <q2:Modifiers>Control</q2:Modifiers>
          </Combinator>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="Combinator">
          <Combinator xsi:type="q2:KeyDown">
            <q2:Key>Q</q2:Key>
            <q2:Modifiers>Control</q2:Modifiers>
          </Combinator>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="Combinator">
          <Combinator xsi:type="q3:SerialStringRead">
            <q3:PortName>COM6</q3:PortName>
            <q3:NewLine>\n</q3:NewLine>
          </Combinator>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="Parse">
          <Pattern>%i\t%i\t%i</Pattern>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="MemberSelector">
          <Selector>Item1</Selector>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="MulticastSubject">
          <Name>WheelDisplacement</Name>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="MemberSelector">
          <Selector>Item2</Selector>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="MulticastSubject">
          <Name>LickStatus</Name>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="Combinator">
          <Combinator xsi:type="TakeUntil" />
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="Combinator">
          <Combinator xsi:type="CombineLatest" />
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="Combinator">
          <Combinator xsi:type="q2:KeyDown">
            <q2:Key>Q</q2:Key>
            <q2:Modifiers>Control</q2:Modifiers>
          </Combinator>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="Combinator">
          <Combinator xsi:type="IntProperty">
            <Value>100</Value>
          </Combinator>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="BehaviorSubject">
          <Name>WheelDisplacement</Name>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="Combinator">
          <Combinator xsi:type="IntProperty">
            <Value>100</Value>
          </Combinator>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="BehaviorSubject">
          <Name>LickStatus</Name>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="Combinator">
          <Combinator xsi:type="DelaySubscription">
            <DueTime>PT5S</DueTime>
          </Combinator>
        </Builder>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>Trial Block 1</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="Concat" />
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="Repeat" />
              </Builder>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="q1:Permutation" />
              </Builder>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="SubscribeSubject">
                <Name>Random</Name>
              </Builder>
            </Expression>
            <Expression xsi:type="WorkflowOutput" />
            <Expression xsi:type="ExternalizedProperty">
              <MemberName>InterStimInterval</MemberName>
              <Name>InterStimInterval</Name>
              <Description>delay time between end of arduino activation and next stimulus presentation</Description>
              <Category>Time Options</Category>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="q4:DotMotionSpecification">
                <q4:Trials>
                  <q4:DotMotionParameters>
                    <q4:Duration>3</q4:Duration>
                    <q4:Size>2</q4:Size>
                    <q4:Colour1>1</q4:Colour1>
                    <q4:Colour2>0</q4:Colour2>
                    <q4:Contrast>1</q4:Contrast>
                    <q4:VelocityX>0</q4:VelocityX>
                    <q4:VelocityY>50</q4:VelocityY>
                    <q4:VelocityZ>0</q4:VelocityZ>
                    <q4:Coherence>100</q4:Coherence>
                    <q4:numDots1>250</q4:numDots1>
                    <q4:numDots2>0</q4:numDots2>
                    <q4:dotLifeBool>0</q4:dotLifeBool>
                    <q4:dotLifetime>20</q4:dotLifetime>
                  </q4:DotMotionParameters>
                  <q4:DotMotionParameters>
                    <q4:Duration>3</q4:Duration>
                    <q4:Size>2</q4:Size>
                    <q4:Colour1>1</q4:Colour1>
                    <q4:Colour2>0</q4:Colour2>
                    <q4:Contrast>1</q4:Contrast>
                    <q4:VelocityX>50</q4:VelocityX>
                    <q4:VelocityY>0</q4:VelocityY>
                    <q4:VelocityZ>0</q4:VelocityZ>
                    <q4:Coherence>100</q4:Coherence>
                    <q4:numDots1>250</q4:numDots1>
                    <q4:numDots2>0</q4:numDots2>
                    <q4:dotLifeBool>0</q4:dotLifeBool>
                    <q4:dotLifetime>20</q4:dotLifetime>
                  </q4:DotMotionParameters>
                  <q4:DotMotionParameters>
                    <q4:Duration>3</q4:Duration>
                    <q4:Size>2</q4:Size>
                    <q4:Colour1>1</q4:Colour1>
                    <q4:Colour2>0</q4:Colour2>
                    <q4:Contrast>1</q4:Contrast>
                    <q4:VelocityX>50</q4:VelocityX>
                    <q4:VelocityY>0</q4:VelocityY>
                    <q4:VelocityZ>0</q4:VelocityZ>
                    <q4:Coherence>100</q4:Coherence>
                    <q4:numDots1>0</q4:numDots1>
                    <q4:numDots2>0</q4:numDots2>
                    <q4:dotLifeBool>0</q4:dotLifeBool>
                    <q4:dotLifetime>1</q4:dotLifetime>
                  </q4:DotMotionParameters>
                </q4:Trials>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="RepeatCount">
                <Count>10</Count>
              </Combinator>
            </Expression>
            <Expression xsi:type="CreateObservable">
              <Name>CreateTrial</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="WorkflowInput">
                    <Name>Source1</Name>
                  </Expression>
                  <Expression xsi:type="ReplaySubject">
                    <Name>Parameters</Name>
                    <BufferSize xsi:nil="true" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="Delay">
                      <DueTime>PT1S</DueTime>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="DueTime" DisplayName="InterStimInterval" />
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                  <Expression xsi:type="GroupWorkflow">
                    <Name>OnState</Name>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>1</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="MulticastSubject">
                          <Name>QuadState</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="First" />
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="2" Label="Source1" />
                        <Edge From="1" To="3" Label="Source1" />
                        <Edge From="2" To="1" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="SelectMany">
                    <Name>DrawStimulus</Name>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="PropertyMapping">
                          <PropertyMappings>
                            <Property Name="numDots" Selector="numDots1" />
                            <Property Name="dotLifetime" Selector="dotLifetime" />
                            <Property Name="Coherence" Selector="Coherence" />
                            <Property Name="VelocityX" Selector="VelocityX" />
                            <Property Name="VelocityY" Selector="VelocityY" />
                            <Property Name="Diameter" Selector="size" />
                            <Property Name="dotLifetimeBool" Selector="dotLifetimeBool" />
                            <Property Name="ColorA" Selector="Contrast" />
                            <Property Name="ColorR" Selector="Colour1" />
                            <Property Name="ColorG" Selector="Colour1" />
                            <Property Name="ColorB" Selector="Colour1" />
                          </PropertyMappings>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="TakeUntil" />
                        </Expression>
                        <Expression xsi:type="SubscribeSubject">
                          <Name>Parameters</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="Last" />
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="Zip" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="q5:Timer">
                            <q5:DueTime>PT3S</q5:DueTime>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="ExternalizedProperty">
                          <MemberName>DueTime</MemberName>
                          <Name>DueTime</Name>
                        </Expression>
                        <Expression xsi:type="MemberSelector">
                          <Selector>Duration</Selector>
                        </Expression>
                        <Expression xsi:type="q6:ExpressionTransform">
                          <q6:Expression>TimeSpan.FromSeconds(it)</q6:Expression>
                        </Expression>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="MemberSelector">
                          <Selector>VelocityX</Selector>
                        </Expression>
                        <Expression xsi:type="MemberSelector">
                          <Selector>VelocityY</Selector>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="q5:UpdateFrame" />
                        </Expression>
                        <Expression xsi:type="MemberSelector">
                          <Selector>TimeStep.ElapsedTime</Selector>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="CombineLatest" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="CombineLatest" />
                        </Expression>
                        <Expression xsi:type="Multiply" />
                        <Expression xsi:type="Multiply" />
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="CombineLatest" />
                        </Expression>
                        <Expression xsi:type="PropertyMapping">
                          <PropertyMappings>
                            <Property Name="VelocityX" Selector="Item1" />
                            <Property Name="VelocityY" Selector="Item2" />
                          </PropertyMappings>
                        </Expression>
                        <Expression xsi:type="MemberSelector">
                          <Selector>numDots1</Selector>
                        </Expression>
                        <Expression xsi:type="MemberSelector">
                          <Selector>numDots2</Selector>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Logging.LogEvent.bonsai">
                          <Format xsi:nil="true" />
                          <Selector xsi:nil="true" />
                          <Name>Events</Name>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="Extensions\MotionCoherenceStimulus.bonsai">
                          <numDots>0</numDots>
                          <dotLifetime>20</dotLifetime>
                          <Coherence>50</Coherence>
                          <VelocityX>-0.5</VelocityX>
                          <VelocityY>0</VelocityY>
                          <Diameter>1</Diameter>
                          <dotLifetimeBool>1</dotLifetimeBool>
                          <ColorA>1</ColorA>
                          <ColorR>1</ColorR>
                          <ColorG>1</ColorG>
                          <ColorB>1</ColorB>
                        </Expression>
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="24" Label="Source1" />
                        <Edge From="1" To="3" Label="Source1" />
                        <Edge From="2" To="23" Label="Source1" />
                        <Edge From="2" To="5" Label="Source2" />
                        <Edge From="2" To="8" Label="Source1" />
                        <Edge From="2" To="11" Label="Source1" />
                        <Edge From="2" To="12" Label="Source1" />
                        <Edge From="2" To="21" Label="Source1" />
                        <Edge From="2" To="22" Label="Source1" />
                        <Edge From="3" To="5" Label="Source1" />
                        <Edge From="5" To="4" Label="Source1" />
                        <Edge From="6" To="1" Label="Source2" />
                        <Edge From="7" To="6" Label="Source1" />
                        <Edge From="8" To="9" Label="Source1" />
                        <Edge From="9" To="7" Label="Source1" />
                        <Edge From="11" To="15" Label="Source1" />
                        <Edge From="12" To="16" Label="Source1" />
                        <Edge From="13" To="14" Label="Source1" />
                        <Edge From="14" To="15" Label="Source2" />
                        <Edge From="14" To="16" Label="Source2" />
                        <Edge From="15" To="17" Label="Source1" />
                        <Edge From="16" To="18" Label="Source1" />
                        <Edge From="17" To="19" Label="Source1" />
                        <Edge From="18" To="19" Label="Source2" />
                        <Edge From="19" To="20" Label="Source1" />
                        <Edge From="20" To="24" Label="Source2" />
                        <Edge From="23" To="0" Label="Source1" />
                        <Edge From="23" To="24" Label="Source3" />
                        <Edge From="24" To="1" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="Sink">
                    <Name>OffState</Name>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>0</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="MulticastSubject">
                          <Name>QuadState</Name>
                        </Expression>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                        <Edge From="1" To="3" Label="Source1" />
                        <Edge From="2" To="0" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="2" To="4" Label="Source1" />
                  <Edge From="3" To="2" Label="Source2" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="2" Label="Source2" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>EnsureDotParameters</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="WorkflowInput">
                    <Name>Source1</Name>
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                  <Expression xsi:type="MemberSelector">
                    <Selector>Index</Selector>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.Duration</Selector>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.Size</Selector>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.Colour1</Selector>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.Contrast</Selector>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.VelocityX</Selector>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.VelocityY</Selector>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="FloatProperty">
                      <Value>1</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="FloatProperty">
                      <Value>1</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="FloatProperty">
                      <Value>1</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="FloatProperty">
                      <Value>1</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="FloatProperty">
                      <Value>0</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="FloatProperty">
                      <Value>0</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="Zip" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="Zip" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="Zip" />
                  </Expression>
                  <Expression xsi:type="q6:ExpressionTransform">
                    <q6:Expression>new(
Item1.Item1 as Id,
Item1.Item2 as Duration,
Item1.Item3 as Colour1,
Item1.Item4 as Colour2,
Item1.Item5 as Contrast,
Item1.Item6 as numDots1,
Item1.Item7 as numDots2,
Item2.Item1 as VelocityX,
Item2.Item2 as VelocityY,
Item2.Item3 as Coherence,
Item2.Item4 as dotLifetime,
Item2.Item5 as dotLifetimeBool,
Item2.Item6 as size)</q6:Expression>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>Duration</Name>
                    <Description>The duration of the trial.</Description>
                    <Category>Default</Category>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>Size</Name>
                    <Category>Default</Category>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>Colour1</Name>
                    <Category>Default</Category>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>Contrast</Name>
                    <Category>Default</Category>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>VelX</Name>
                    <Category>Default</Category>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>VelY</Name>
                    <Category>Default</Category>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="ElementIndex" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.Coherence</Selector>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="FloatProperty">
                      <Value>100</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>Coherence</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.numDots1</Selector>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="FloatProperty">
                      <Value>200</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>numDots1</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.dotLifetime</Selector>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="IntProperty">
                      <Value>1000</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>dotLifetime</Name>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>dotLifeBool</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.dotLifeBool</Selector>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="IntProperty">
                      <Value>0</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.numDots2</Selector>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="FloatProperty">
                      <Value>0</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>numDots2</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Value.Colour2</Selector>
                  </Expression>
                  <Expression xsi:type="GetValueOrDefault">
                    <Operand xsi:type="FloatProperty">
                      <Value>0</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="ExternalizedProperty">
                    <MemberName>Value</MemberName>
                    <Name>Colour2</Name>
                    <Category>Default</Category>
                  </Expression>
                </Nodes>
                <Edges>
                  <Edge From="0" To="25" Label="Source1" />
                  <Edge From="2" To="15" Label="Source1" />
                  <Edge From="3" To="9" Label="Source1" />
                  <Edge From="4" To="10" Label="Source1" />
                  <Edge From="5" To="11" Label="Source1" />
                  <Edge From="6" To="12" Label="Source1" />
                  <Edge From="7" To="13" Label="Source1" />
                  <Edge From="8" To="14" Label="Source1" />
                  <Edge From="9" To="15" Label="Source2" />
                  <Edge From="10" To="16" Label="Source6" />
                  <Edge From="11" To="15" Label="Source3" />
                  <Edge From="12" To="15" Label="Source5" />
                  <Edge From="13" To="16" Label="Source1" />
                  <Edge From="14" To="16" Label="Source2" />
                  <Edge From="15" To="17" Label="Source1" />
                  <Edge From="16" To="17" Label="Source2" />
                  <Edge From="17" To="18" Label="Source1" />
                  <Edge From="18" To="1" Label="Source1" />
                  <Edge From="19" To="9" Label="Source2" />
                  <Edge From="20" To="10" Label="Source2" />
                  <Edge From="21" To="11" Label="Source2" />
                  <Edge From="22" To="12" Label="Source2" />
                  <Edge From="23" To="13" Label="Source2" />
                  <Edge From="24" To="14" Label="Source2" />
                  <Edge From="25" To="2" Label="Source1" />
                  <Edge From="25" To="3" Label="Source1" />
                  <Edge From="25" To="4" Label="Source1" />
                  <Edge From="25" To="5" Label="Source1" />
                  <Edge From="25" To="6" Label="Source1" />
                  <Edge From="25" To="7" Label="Source1" />
                  <Edge From="25" To="8" Label="Source1" />
                  <Edge From="25" To="26" Label="Source1" />
                  <Edge From="25" To="29" Label="Source1" />
                  <Edge From="25" To="32" Label="Source1" />
                  <Edge From="25" To="36" Label="Source1" />
                  <Edge From="25" To="38" Label="Source1" />
                  <Edge From="25" To="41" Label="Source1" />
                  <Edge From="26" To="27" Label="Source1" />
                  <Edge From="27" To="16" Label="Source3" />
                  <Edge From="28" To="27" Label="Source2" />
                  <Edge From="29" To="30" Label="Source1" />
                  <Edge From="30" To="15" Label="Source6" />
                  <Edge From="31" To="30" Label="Source2" />
                  <Edge From="32" To="33" Label="Source2" />
                  <Edge From="33" To="16" Label="Source4" />
                  <Edge From="34" To="33" Label="Source2" />
                  <Edge From="35" To="37" Label="Source2" />
                  <Edge From="36" To="37" Label="Source1" />
                  <Edge From="37" To="16" Label="Source5" />
                  <Edge From="38" To="39" Label="Source1" />
                  <Edge From="39" To="15" Label="Source7" />
                  <Edge From="40" To="39" Label="Source2" />
                  <Edge From="41" To="42" Label="Source1" />
                  <Edge From="42" To="15" Label="Source4" />
                  <Edge From="43" To="42" Label="Source2" />
                </Edges>
              </Workflow>
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="7" Label="Source1" />
            <Edge From="2" To="8" Label="Source1" />
            <Edge From="3" To="2" Label="Source2" />
            <Edge From="5" To="8" Label="Source2" />
            <Edge From="6" To="9" Label="Source1" />
            <Edge From="7" To="4" Label="Source1" />
            <Edge From="8" To="0" Label="Source1" />
            <Edge From="9" To="2" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>QuadState</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="SubscribeSubject">
              <Name>DrawStimuli</Name>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="ColorR" Selector="it" />
                <Property Name="ColorG" Selector="it" />
                <Property Name="ColorB" Selector="it" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>0</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="BehaviorSubject">
              <Name>QuadState</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>QuadState</Name>
            </Expression>
            <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.DrawQuad.bonsai">
              <ExtentX>1</ExtentX>
              <ExtentY>1</ExtentY>
              <LocationX>88</LocationX>
              <LocationY>-43</LocationY>
              <ColorR>1</ColorR>
              <ColorG>1</ColorG>
              <ColorB>1</ColorB>
              <ColorA>1</ColorA>
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="5" Label="Source1" />
            <Edge From="1" To="5" Label="Source2" />
            <Edge From="2" To="3" Label="Source1" />
            <Edge From="4" To="1" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>Display and Resources</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="q5:RenderFrame" />
            </Expression>
            <Expression xsi:type="PublishSubject">
              <Name>DrawStimuli</Name>
            </Expression>
            <Expression xsi:type="WorkflowOutput" />
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="q5:CreateWindow">
                <q5:Width>1280</q5:Width>
                <q5:Height>960</q5:Height>
                <q5:VSync>On</q5:VSync>
                <q5:SwapSync>false</q5:SwapSync>
                <q5:ClearColor>Gray</q5:ClearColor>
                <q5:ClearMask>DepthBufferBit ColorBufferBit</q5:ClearMask>
                <q5:CursorVisible>true</q5:CursorVisible>
                <q5:Location xsi:nil="true" />
                <q5:WindowBorder>Resizable</q5:WindowBorder>
                <q5:WindowState>Normal</q5:WindowState>
                <q5:DisplayDevice>Primary</q5:DisplayDevice>
                <q5:TargetRenderFrequency>0</q5:TargetRenderFrequency>
                <q5:RenderState />
                <q5:GraphicsMode>
                  <q5:ColorFormat>
                    <q5:Red>8</q5:Red>
                    <q5:Green>8</q5:Green>
                    <q5:Blue>8</q5:Blue>
                    <q5:Alpha>8</q5:Alpha>
                  </q5:ColorFormat>
                  <q5:Depth>16</q5:Depth>
                  <q5:Stencil>0</q5:Stencil>
                  <q5:Samples>0</q5:Samples>
                  <q5:AccumulatorFormat>
                    <q5:Red>0</q5:Red>
                    <q5:Green>0</q5:Green>
                    <q5:Blue>0</q5:Blue>
                    <q5:Alpha>0</q5:Alpha>
                  </q5:AccumulatorFormat>
                  <q5:Buffers>2</q5:Buffers>
                  <q5:Stereo>false</q5:Stereo>
                </q5:GraphicsMode>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="q5:ShaderResources">
                <q5:Shaders />
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="q5:MeshResources">
                <q5:Meshes />
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="q5:TextureResources">
                <q5:Textures />
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="q5:LoadResources" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>45</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="ReplaySubject">
              <Name>Top</Name>
              <BufferSize xsi:nil="true" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>-45</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="ReplaySubject">
              <Name>Bottom</Name>
              <BufferSize xsi:nil="true" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>-90</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="ReplaySubject">
              <Name>Left</Name>
              <BufferSize xsi:nil="true" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>90</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="ReplaySubject">
              <Name>Right</Name>
              <BufferSize xsi:nil="true" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="Zip" />
            </Expression>
            <Expression xsi:type="ReplaySubject">
              <Name>Borders</Name>
              <BufferSize xsi:nil="true" />
            </Expression>
            <Expression xsi:type="ExternalizedProperty">
              <MemberName>Value</MemberName>
              <Name>TopBorder</Name>
              <Category>Display</Category>
            </Expression>
            <Expression xsi:type="ExternalizedProperty">
              <MemberName>Value</MemberName>
              <Name>BottomBorder</Name>
              <Category>Display</Category>
            </Expression>
            <Expression xsi:type="ExternalizedProperty">
              <MemberName>Value</MemberName>
              <Name>LeftBorder</Name>
              <Category>Display</Category>
            </Expression>
            <Expression xsi:type="ExternalizedProperty">
              <MemberName>Value</MemberName>
              <Name>RightBorder</Name>
              <Category>Display</Category>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>ScreenBorders</Name>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="Top" Selector="Item1" />
                <Property Name="Bottom" Selector="Item2" />
                <Property Name="Left" Selector="Item3" />
                <Property Name="Right" Selector="Item4" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="q4:AlterBorders">
                <q4:TopAdjust>0</q4:TopAdjust>
                <q4:BottomAdjust>5</q4:BottomAdjust>
                <q4:LeftAdjust>0</q4:LeftAdjust>
                <q4:RightAdjust>0</q4:RightAdjust>
              </Combinator>
            </Expression>
            <Expression xsi:type="ReplaySubject">
              <Name>ScreenBorders</Name>
              <BufferSize xsi:nil="true" />
            </Expression>
            <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.PrimitiveResources.bonsai" />
            <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.OrthographicViewport.bonsai">
              <Left>-90</Left>
              <Right>90</Right>
              <Bottom>-45</Bottom>
              <Top>45</Top>
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="27" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="3" To="26" Label="Source1" />
            <Edge From="4" To="5" Label="Source1" />
            <Edge From="5" To="6" Label="Source1" />
            <Edge From="6" To="7" Label="Source1" />
            <Edge From="8" To="9" Label="Source1" />
            <Edge From="9" To="16" Label="Source1" />
            <Edge From="10" To="11" Label="Source1" />
            <Edge From="11" To="16" Label="Source2" />
            <Edge From="12" To="13" Label="Source1" />
            <Edge From="13" To="16" Label="Source3" />
            <Edge From="14" To="15" Label="Source1" />
            <Edge From="15" To="16" Label="Source4" />
            <Edge From="16" To="25" Label="Source1" />
            <Edge From="18" To="8" Label="Source1" />
            <Edge From="19" To="10" Label="Source1" />
            <Edge From="20" To="12" Label="Source1" />
            <Edge From="21" To="14" Label="Source1" />
            <Edge From="22" To="23" Label="Source1" />
            <Edge From="23" To="27" Label="Source2" />
            <Edge From="24" To="17" Label="Source1" />
            <Edge From="25" To="24" Label="Source1" />
            <Edge From="26" To="4" Label="Source1" />
            <Edge From="27" To="1" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="IncludeWorkflow" Path="BonVision:Logging.TimestampedEventLogger.bonsai">
        <Name>Events</Name>
        <Overwrite>false</Overwrite>
        <Suffix>Timestamp</Suffix>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="Sink">
          <Name>EphysOff</Name>
          <Workflow>
            <Nodes>
              <Expression xsi:type="Combinator">
                <Combinator xsi:type="BooleanProperty">
                  <Value>false</Value>
                </Combinator>
              </Expression>
              <Expression xsi:type="Combinator">
                <Combinator xsi:type="q7:DigitalOutput">
                  <q7:PortName>COM4</q7:PortName>
                  <q7:Pin>13</q7:Pin>
                </Combinator>
              </Expression>
              <Expression xsi:type="WorkflowInput">
                <Name>Source1</Name>
              </Expression>
              <Expression xsi:type="WorkflowOutput" />
            </Nodes>
            <Edges>
              <Edge From="0" To="1" Label="Source1" />
              <Edge From="1" To="3" Label="Source1" />
              <Edge From="2" To="0" Label="Source1" />
            </Edges>
          </Workflow>
        </Builder>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="GroupWorkflow">
          <Name>EphysOn</Name>
          <Workflow>
            <Nodes>
              <Expression xsi:type="Combinator">
                <Combinator xsi:type="BooleanProperty">
                  <Value>true</Value>
                </Combinator>
              </Expression>
              <Expression xsi:type="WorkflowInput">
                <Name>Source1</Name>
              </Expression>
              <Expression xsi:type="WorkflowOutput" />
              <Expression xsi:type="Combinator">
                <Combinator xsi:type="q7:DigitalOutput">
                  <q7:PortName>COM4</q7:PortName>
                  <q7:Pin>13</q7:Pin>
                </Combinator>
              </Expression>
            </Nodes>
            <Edges>
              <Edge From="0" To="3" Label="Source1" />
              <Edge From="1" To="0" Label="Source1" />
              <Edge From="3" To="2" Label="Source1" />
            </Edges>
          </Workflow>
        </Builder>
      </Expression>
    </Nodes>
    <Edges>
      <Edge From="0" To="3" Label="Source1" />
      <Edge From="1" To="2" Label="Source1" />
      <Edge From="3" To="28" Label="Source1" />
      <Edge From="4" To="27" Label="Source1" />
      <Edge From="5" To="27" Label="Source2" />
      <Edge From="6" To="27" Label="Source3" />
      <Edge From="7" To="27" Label="Source4" />
      <Edge From="8" To="25" Label="Source1" />
      <Edge From="9" To="30" Label="Source1" />
      <Edge From="10" To="29" Label="Source1" />
      <Edge From="11" To="12" Label="Source1" />
      <Edge From="12" To="13" Label="Source1" />
      <Edge From="12" To="15" Label="Source1" />
      <Edge From="13" To="14" Label="Source1" />
      <Edge From="14" To="18" Label="Source1" />
      <Edge From="15" To="16" Label="Source1" />
      <Edge From="16" To="18" Label="Source2" />
      <Edge From="18" To="17" Label="Source1" />
      <Edge From="19" To="17" Label="Source2" />
      <Edge From="20" To="21" Label="Source1" />
      <Edge From="22" To="23" Label="Source1" />
      <Edge From="25" To="24" Label="Source1" />
    </Edges>
  </Workflow>
  <ExtensionTypes>
    <Type>Bonsai.Expressions.StringProperty, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Numerics.CreateRandom, Bonsai.Numerics, Version=0.1.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Expressions.AsyncSubjectBuilder, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.Take, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Shaders.Input.KeyDown, Bonsai.Shaders, Version=0.19.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.IO.SerialStringRead, Bonsai.System, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Expressions.ParseBuilder, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Expressions.MulticastSubjectBuilder, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.TakeUntil, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.CombineLatest, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Expressions.IntProperty, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.DelaySubscription, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.Concat, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.Repeat, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Numerics.Permutation, Bonsai.Numerics, Version=0.1.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>DotMotionSpecification, Extensions, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.RepeatCount, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.Delay, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Expressions.FloatProperty, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.First, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.Last, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.Zip, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Shaders.Timer, Bonsai.Shaders, Version=0.19.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Scripting.ExpressionTransform, Bonsai.Scripting, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Shaders.UpdateFrame, Bonsai.Shaders, Version=0.19.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Expressions.MultiplyBuilder, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Expressions.SinkBuilder, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Expressions.GetValueOrDefaultBuilder, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Reactive.ElementIndex, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Shaders.RenderFrame, Bonsai.Shaders, Version=0.19.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Shaders.CreateWindow, Bonsai.Shaders, Version=0.19.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Shaders.ShaderResources, Bonsai.Shaders, Version=0.19.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Shaders.MeshResources, Bonsai.Shaders, Version=0.19.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Shaders.TextureResources, Bonsai.Shaders, Version=0.19.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Shaders.LoadResources, Bonsai.Shaders, Version=0.19.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>AlterBorders, Extensions, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Expressions.BooleanProperty, Bonsai.Core, Version=2.4.0.0, Culture=neutral, PublicKeyToken=null</Type>
    <Type>Bonsai.Arduino.DigitalOutput, Bonsai.Arduino, Version=2.3.0.0, Culture=neutral, PublicKeyToken=null</Type>
  </ExtensionTypes>
</WorkflowBuilder>